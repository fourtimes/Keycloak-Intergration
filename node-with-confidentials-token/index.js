var express = require('express');
var app = express();

const keycloak = require('./config/keycloak-config.js').initKeycloak();
app.use(keycloak.middleware());


const testController = require('./controller/test-controller.js');
app.use('/test', testController);

app.get('/', (req, res) => {
    res.send("Server is up!");
});

app.listen(3000);   

// curl -X GET 'http://localhost:3000/test/user' \
// --header 'Authorization: bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJnbWJaQVdEblVBTXVQWVFEbWdtT3laNjJHQ2xNbmxNb3hpU09SVFo3R01ZIn0.eyJleHAiOjE3MDYwMTA3NTIsImlhdCI6MTcwNjAxMDQ1MiwianRpIjoiZGVkYjU0OWItN2Q5NC00ZTI3LTkxMTQtMjU1ODNkNzA1Nzk1IiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2F1dGgvcmVhbG1zL0RlbW8tUmVhbG0iLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiY2Y2NzEyODAtYWUzNS00ZTE3LTkwNDktM2VkMTk0YThkZTQwIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoibm9kZWpzLW1pY3Jvc2VydmljZSIsInNlc3Npb25fc3RhdGUiOiI5NTk5ZjJmNy1hNzFlLTQ3OTQtODgwZC0xMTA1OGY0YjRhMTIiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly9sb2NhbGhvc3Q6ODA4MCJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJkZWZhdWx0LXJvbGVzLWRlbW8tcmVhbG0iLCJ1bWFfYXV0aG9yaXphdGlvbiIsImFwcC11c2VyIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsibm9kZWpzLW1pY3Jvc2VydmljZSI6eyJyb2xlcyI6WyJ1c2VyIl19LCJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6ImVtYWlsIHByb2ZpbGUiLCJzaWQiOiI5NTk5ZjJmNy1hNzFlLTQ3OTQtODgwZC0xMTA1OGY0YjRhMTIiLCJlbWFpbF92ZXJpZmllZCI6dHJ1ZSwicHJlZmVycmVkX3VzZXJuYW1lIjoiZW1wbG95ZWUxIn0.SvnXPh_NJkZDKivKcj8cIsqgg1phqYVSIEZfU6EIXcl7wN6NTnHHUklWfZsQ-tpzj1nBM4wicGT2PsCkCyTMGgrBrsRDDYv97Eh4gM41u6mYtw6us6mTBWlEQg8aJVO-fLVx3mWvsdMlxEn7kAXL_nvV3cDVt-ZV3YWnz5iw3PQg5uO9iyJVMLlWIjVBokfrkJRBgIYWLTLK5qxnS8zjDKX1qC9zVHu0R2h0I0eoOpsRmtrwhnYtGLX9OXvrgDHqtZFXrDn8oN9agYrTSbxdoNpXmtshTaCvBW-8bP4JgP4DTK0I8sS6MzURqgLb-7kKyYg3Kt7Fg6Ull8en5a8IHQ'